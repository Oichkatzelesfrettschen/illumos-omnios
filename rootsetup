#!/bin/sh

# Fail on first error
set -e

# Update package lists to fetch latest versions
sudo apt-get update -y

# List of core build tools and libraries
PACKAGES="\
    build-essential\
    doxygen\
    python3-sphinx\
    python3-breathe\
    python3-sphinx-rtd-theme\
    cloc\
    qemu-system-x86\
    qemu-utils\
"

# Include python3-sphinxcontrib when provided
if apt-cache show python3-sphinxcontrib >/dev/null 2>&1; then
    PACKAGES="$PACKAGES python3-sphinxcontrib"
fi

# Append preferred terminal multiplexer
if apt-cache show tmux-headless >/dev/null 2>&1; then
    # Use headless variant when available
    PACKAGES="$PACKAGES tmux-headless"
else
    PACKAGES="$PACKAGES tmux"
fi

# Install packages in one go
sudo apt-get install -y $PACKAGES
